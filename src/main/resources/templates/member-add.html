<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">

<!-- Header Fragment -->
<head th:replace="fragments/header :: header(pageTitle='DBLOC IBS - Add Member')"></head>

<body>
    <!-- Navigation Fragment -->
    <nav th:replace="fragments/navigation :: navigation"></nav>
    
    <div class="container" style="margin-top: 70px;">

        <div class="row">
            <div class="content-box">
                <div>
                    <div class="page-header">
                        <h3>DBLOC-IBS Members</h3>
                    </div>
                </div>
                <form class="form-horizontal" action="#" th:action="@{/admin/member/member-create}" th:object="${member}" method="post">
                	<div class="col-xs-12">
                		<h5>Personal Information</h5>
                		<div class="col-xs-6">
                			<div class="form-group">  
		                        <label class="control-label col-xs-4">First Name</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{firstName}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Last Name</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{lastName}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Middle Initial</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{middleName}" class="form-control number"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('middleName')}" th:errors="*{middleName}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">
		                    	<label class="control-label col-xs-4">Birthday</label>
				                <div class="input-group date-group date col-xs-8">
				                    <input type="text" th:field="*{birthdayString}"  class="form-control" />
				                    <span class="input-group-addon">
				                        <i class="fa fa-calendar"></i>
				                    </span>
				                    <span class="help-inline" th:if="${#fields.hasErrors('birthdayString')}" th:errors="*{birthdayString}">error</span>
				                </div>
				            </div>
				            <div class="form-group">  
		                        <label class="control-label col-xs-4">Age</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{age}" class="form-control number"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('age')}" th:errors="*{age}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Contact No.</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{contactNo}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('contactNo')}" th:errors="*{contactNo}">error</span>
		                        </div>
		                    </div>
                		</div>
                		<div class="col-xs-6">
                			<div class="form-group">  
		                        <label class="control-label col-xs-4">Street Address</label>
		                        <div class="col-xs-8">
		                            <textarea rows="3" th:field="*{address}" class="form-control"></textarea>
		                            <span class="help-inline" th:if="${#fields.hasErrors('address')}" th:errors="*{address}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">City</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{city}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('city')}" th:errors="*{city}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Civil Status</label>
		                        <div class="col-xs-8">
		                            <select th:field="*{civilStatus}" class="form-control">
		                            	<option value=""></option>
		                            	<option value="Single">Single</option>
		                            	<option value="Married">Married</option>
		                            	<option value="Widowed">Widowed</option>
		                            	<option value="Separated">Separated</option>
		                            	<option value="Divorced">Divorced</option>
		                            	<option value="Other">Other</option>
		                            </select>
		                            <span class="help-inline" th:if="${#fields.hasErrors('civilStatus')}" th:errors="*{civilStatus}">error</span>
		                        </div>
		                    </div>
				            <div class="form-group">  
		                        <label class="control-label col-xs-4">TIN</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{tinNumber}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('tinNumber')}" th:errors="*{tinNumber}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Occupation</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{occupation}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('occupation')}" th:errors="*{occupation}">error</span>
		                        </div>
		                    </div>
                		</div>
                	</div>
                	<div class="col-xs-12">
                		<h5>Account Information</h5>
                		<div class="col-xs-6">
                			<div class="form-group">  
		                        <label class="control-label col-xs-4">Username</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{username}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('username')}" th:errors="*{username}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Password</label>
		                        <div class="col-xs-8">
		                            <input type="password" th:field="*{newPassword}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('newPassword')}" th:errors="*{newPassword}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Confirm Password</label>
		                        <div class="col-xs-8">
		                            <input type="password" th:field="*{confirmPassword}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">No. of Accounts</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{numOfAccounts}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('numOfAccounts')}" th:errors="*{numOfAccounts}">error</span>
		                        </div>
		                    </div>
                		</div>
                		<div class="col-xs-6">
                			<div class="form-group">
		                    	<label class="control-label col-xs-4">Date and time joined</label>
				                <div class="input-group date-group date col-xs-8">
				                    <input type="text" th:field="*{dateJoinedString}"  class="form-control" />
				                    <span class="input-group-addon">
				                        <i class="fa fa-calendar"></i>
				                    </span>
				                    <span class="help-inline" th:if="${#fields.hasErrors('dateJoinedString')}" th:errors="*{dateJoinedString}">error</span>
				                </div>
				            </div>
				            <div class="form-group">  
		                        <label class="control-label col-xs-4">Referrer</label>
		                        <div class="col-xs-8">
		                        	<select th:field="*{referrer}" class="form-control">
		                        		<option value="0">Select a Member...</option>
		                        		<th:block th:each="member : ${memberList}">
		                        			<option th:value="${member.id}" th:text="${member.completeName}"></option>
		                        		</th:block>
		                        	</select>
		                        	<input type="hidden" th:field="*{referrerId}"/>
		                        	<input type="hidden" th:field="*{referrerCompleteName}"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('referrer')}" th:errors="*{referrer}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">User Type</label>
		                        <div class="col-xs-8">
		                            <select th:field="*{tempRole}" class="form-control">
		                            	<option value="USER">Member</option>
		                            	<option value="ADMIN">Admin and Member</option>
		                            </select>
		                            <span class="help-inline" th:if="${#fields.hasErrors('tempRole')}" th:errors="*{tempRole}">error</span>
		                        </div>
		                    </div>
		                    <div class="form-group">  
		                        <label class="control-label col-xs-4">Email</label>
		                        <div class="col-xs-8">
		                            <input type="text" th:field="*{email}" class="form-control"/>
		                            <span class="help-inline" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">error</span>
		                        </div>
		                    </div>
                		</div>
                	</div>
                    <div class="col-xs-12">
                    	<div class="col-xs-4"></div>
                    	<button type="submit" class="btn gold-button col-xs-4">Save</button>
                    	<div class="col-xs-4"></div>
                   	</div>
                </form>
                </div>
			</div>
			
			<div>
				<span id="member-created" th:text="${memberCreate}"></span>
			</div>
		</div>
		
		<div id="newMemberAdded" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="New Member Added" aria-hidden="true"
			data-backdrop="static" data-keyboard="false">
	        <div class="vertical-alignment-helper">
	            <div class="modal-dialog vertical-align-center">
	                <div class="modal-content">
	                    <div class="modal-header">
	                        <h4 class="modal-title text-center"><i class="fa fa-info-circle"></i><span> New Member Added</span></h4>
	                    </div>
	                    <div class="modal-footer" style="text-align: center;">
	                        <button id="new-member-okay" class="btn btn-success">Okay</button>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
	<!-- Footer Fragment -->
    <footer th:replace="fragments/footer :: footer"></footer>

    <script type="text/javascript">
	//<![CDATA[
	    $(document).ready(function() {
	    	$('#birthdayString').datetimepicker({
				format: "MM/DD/YYYY"
			});
	    	$('#dateJoinedString').datetimepicker({
	    		defaultDate: new Date()
	    	});
	    	
	    	// For all input error
	    	$('span.help-inline').each(function(i,elem) {
	    		$(elem).closest('.form-group').addClass('has-error');
	    	});
	    	
	    	// Modal after member is successfully saved
	    	if($('#member-created').text() == 'success') {
	    		$('#newMemberAdded').modal('show');
	    		setTimeout(function () {
	    			window.location.href = "/members";
	    		}, 3000);
	    	}
	    	
	    	$('#referrer').select2();
	    	
	    	if($('#referrerId').val() != '') {
	    		$('#referrer').select2('data', {id:$('#referrerId').val(),text:$('#referrerCompleteName').val()});
	    	}
		}).on('click', '#new-member-okay', function() {
			window.location.href = "/members";
		});
	    
	    $('#age, #numOfAccounts').keydown(function(e) {
	        // Allow: backspace, delete, tab, escape, enter
	        if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110]) !== -1 ||
	             // Allow: Ctrl+A
	            (e.keyCode == 65 && e.ctrlKey === true) ||
	             // Allow: Ctrl+C
	            (e.keyCode == 67 && e.ctrlKey === true) ||
	             // Allow: Ctrl+X
	            (e.keyCode == 88 && e.ctrlKey === true) ||
	             // Allow: home, end, left, right
	            (e.keyCode >= 35 && e.keyCode <= 39)) {
	                 // let it happen, don't do anything
	                 return;
	        }
	        // Ensure that it is a number and stop the keypress
	        if ( (e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105) ) {
	            e.preventDefault();
	        };
	    });
	//]]>
    </script>

</body>

</html>